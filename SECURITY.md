# Security Policy

I take the security of this project seriously. This document outlines my security practices and how to report vulnerabilities.

---

## ğŸ”’ Security Practices

I've implemented multiple layers of security:

### 1. No Arbitrary Code Execution

**The #1 security principle I follow**: I NEVER execute code generated by the LLM.

- All LLM outputs are JSON specifications validated with Pydantic
- I use only whitelisted operations (enums)
- No `eval()`, `exec()`, `compile()`, or `__import__()` anywhere
- All data transformations use safe Pandas operations

### 2. Input Validation

I validate all user inputs:

- **Filenames**: I sanitize to prevent directory traversal attacks
- **File sizes**: I enforce configurable limits (default: 50MB)
- **File types**: I only accept CSV and XLSX
- **Column names**: I strip dangerous characters (`eval`, `exec`, `;`, etc.)
- **Filter values**: I validate types and reject callables

### 3. API Key Protection

I protect sensitive credentials:

- API keys loaded from environment variables ONLY
- Never logged, printed, or included in error messages
- Automatic redaction in structured logs
- Not committed to version control (.env in .gitignore)

### 4. Dependency Management

I maintain secure dependencies:

- Regular updates via Dependabot (coming soon)
- Pin exact versions in production
- Scan for vulnerabilities with Trivy (in CI/CD)
- Minimal dependency tree

### 5. Container Security

I build secure Docker images:

- Non-root user (`appuser`)
- Minimal base image (python:3.12-slim)
- No unnecessary packages
- Multi-stage builds to reduce image size
- Security scanning in CI/CD

---

## ğŸ” Known Security Considerations

### Rate Limiting

I implement basic rate limiting for LLM calls, but you should:

- Set `MAX_LLM_CALLS_PER_MINUTE` appropriately
- Monitor API usage
- Implement additional rate limiting at the infrastructure level

### File Upload Limits

I default to 50MB max file size, but:

- Adjust based on your infrastructure
- Consider memory constraints
- Implement disk quotas

### API Key Exposure

While I never log API keys:

- Ensure your `.env` file is never committed
- Use secrets management in production (e.g., Kubernetes Secrets, AWS Secrets Manager)
- Rotate keys regularly

---

## ğŸš¨ Reporting a Vulnerability

If you discover a security vulnerability, I ask that you:

### DO:

1. **Email me directly** at [security@example.com] with:
   - Description of the vulnerability
   - Steps to reproduce
   - Potential impact
   - Suggested fix (if you have one)

2. **Give me time to respond**: I'll acknowledge receipt within 48 hours

3. **Allow me to fix it**: I'll work on a patch and coordinate disclosure

4. **Keep it confidential** until I've released a fix

### DON'T:

- âŒ Open a public GitHub issue for security vulnerabilities
- âŒ Share the vulnerability publicly before I've patched it
- âŒ Exploit the vulnerability maliciously

---

## ğŸ›¡ï¸ Security Response Process

Here's how I handle security reports:

1. **Acknowledgment**: I'll confirm receipt within 48 hours
2. **Assessment**: I'll evaluate severity and impact (24-72 hours)
3. **Fix Development**: I'll create and test a patch (1-7 days depending on severity)
4. **Disclosure**: I'll coordinate a responsible disclosure timeline
5. **Credit**: I'll credit you in the security advisory (unless you prefer anonymity)

### Severity Levels

I classify vulnerabilities as:

- **Critical**: Remote code execution, authentication bypass
- **High**: Data exposure, privilege escalation
- **Medium**: DoS, information disclosure
- **Low**: Minor information leaks, low-impact issues

---

## ğŸ” Security Best Practices for Users

If you're deploying this application, I recommend:

### Environment Configuration

```bash
# Never commit .env files
echo ".env" >> .gitignore

# Use strong API keys
OPENAI_API_KEY=sk-proj-...  # Full-length production key

# Set restrictive file limits
MAX_UPLOAD_SIZE_MB=50  # Adjust based on your needs

# Enable security features
SANITIZE_FILENAMES=true
```

### Deployment

```bash
# Use secrets management
kubectl create secret generic ai-viz-secrets \
  --from-literal=openai-api-key=$OPENAI_API_KEY

# Limit container privileges
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  allowPrivilegeEscalation: false

# Use network policies
# Limit egress to OpenAI API only
```

### Monitoring

I recommend monitoring:

- Failed authentication attempts (future feature)
- Unusual file upload patterns
- High LLM API usage
- Error rates
- Response times

---

## ğŸ“Š Security Audit History

I maintain transparency about security:

| Date | Type | Severity | Status |
|------|------|----------|--------|
| 2026-02-07 | Initial Release | N/A | âœ… No known vulnerabilities |

---

## ğŸ”„ Security Updates

I'll announce security updates through:

- GitHub Security Advisories
- Release notes
- CHANGELOG.md
- Email notifications (for critical issues)

---

## ğŸ§ª Security Testing

I perform:

- **Static Analysis**: Ruff, Bandit (coming soon)
- **Dependency Scanning**: Trivy in CI/CD
- **Container Scanning**: Trivy in CI/CD
- **Manual Review**: Code review for all changes

You can run security checks locally:

```bash
# Install security tools
uv pip install bandit safety

# Run Bandit (Python security linter)
bandit -r . -ll

# Check dependencies for known vulnerabilities
safety check

# Scan Docker image
trivy image ai-data-viz-agent:latest
```

---

## ğŸ“œ Compliance

This project:

- âœ… Does not store user data persistently (except chat history locally)
- âœ… Does not transmit data except to OpenAI API
- âœ… Logs are configurable and can exclude sensitive data
- âœ… Source code is auditable (open source)

For GDPR/CCPA compliance:

- I recommend deploying in your own infrastructure
- Chat history is stored locally (SQLite) - you control it
- No telemetry or analytics are sent to external services
- Users can delete their data by removing the SQLite database

---

## ğŸ”— External Security Resources

I recommend these resources:

- **OWASP Top 10**: https://owasp.org/www-project-top-ten/
- **CWE (Common Weakness Enumeration)**: https://cwe.mitre.org/
- **Python Security Best Practices**: https://python.readthedocs.io/en/stable/library/security_warnings.html
- **Docker Security**: https://docs.docker.com/engine/security/

---

## ğŸ–ï¸ Responsible Disclosure Hall of Fame

I'll recognize security researchers who responsibly disclose vulnerabilities:

(No entries yet - be the first!)

---

## ğŸ“§ Contact

For security concerns:

- **Email**: security@example.com
- **PGP Key**: (Add your PGP key for encrypted communication)

For non-security issues:

- **GitHub Issues**: https://github.com/yourorg/ai-data-viz-agent/issues
- **GitHub Discussions**: https://github.com/yourorg/ai-data-viz-agent/discussions

---

**Thank you for helping me keep this project secure! ğŸ”’**
